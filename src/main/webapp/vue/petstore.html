<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="css/app.css">
  <script src="https://unpkg.com/vue@2"></script>
</head>
<body>
  <div id="app">
    <header>
      <!-- <h1>{{sitename}}</h1> -->
      <h1 v-text="sitename"></h1>
    </header>
    <main>
      <div class="row product">
        <div class = "col">
          <figure>
            <img v-bind:src="product.image">
          </figure>
        </div>
        <div class="col col-extpand">
          <h1 v-text-="product.title"></h1>
          <p v-html="product.description"></p>
          <p>{{product.price | formatPrice}}</p>
        </div>
      </div>
    </main>
  </div>
  <script>
    var APP_LOG_LIFECYCLE_EVENT = false;
    let store = new Vue({
      el:'#app', //vue객체가 데이터를 만들어서 보여주는 옵션 = el id값이 app인 곳에 담겠다는 뜻임ㅇㅇ
      data : {
        sitename : 'Vue.js 애완용품샵',   //여기가 바뀌면 바로 화면영역에반영? vue인스턴스가 계속 돌다가 데이터가 바뀌면 dom영역에 그려줌ㅇㅇ     
        product : {
          id : 1001,
          title : '고양이 사료, 25파운드',
          description : "당신의 고양이를 위한 <em>거부할 수 없는</em>, 유기농 25파운드 사료입니다.",
          price : 2000,
          image : 'images/product-fullsize.png'
        }
      },
      //
      filters : {
        formatPrice : function(price){
          // 99999 : 999.99 2000.00 -> 20.00
          if(!parseInt(price)){return "";}
          if(price > 99999){
            var priceString = (price / 100).toFixed(2);
            console.log(priceString);
            var priceArray = priceString.split("").reverse();
            console.log(priceArray)
            var index = 3;
            while(priceArray.length > index + 3){
              priceArray.splice(index + 3, 0, ','); //[1, 2, 3, 4].splice(1, 0, '5')
              index += 4;
            }
            return "$" + priceArray.reverse().join('');
          }else{
            return "$" + (price / 100).toFixed(2);
          }
        }
      },
      
      //vue생명주기
      beforeCreate : function(){
        if( APP_LOG_LIFECYCLE_EVENT){
          console.log('beforeCreate hook.')
        }
      },
      created : function(){
        if( APP_LOG_LIFECYCLE_EVENT){
          console.log('created hook.')
          fetch('data.json')
          .then(resolve => resolve.json())
          .then(result => store.sitename = result.sitename)
          .catch(err => console.log);
        }
      },
      beforeMount : function(){
        if( APP_LOG_LIFECYCLE_EVENT){
          console.log('beforeMount hook.')
        }
      },
      mounted : function(){
        if( APP_LOG_LIFECYCLE_EVENT){
          console.log('mounted hook.')
        }
      },
      beforeUpdate : function(){
        if( APP_LOG_LIFECYCLE_EVENT){
          console.log('beforeUpdate hook.')
        }
      },
      updated : function(){
        if( APP_LOG_LIFECYCLE_EVENT){
          console.log('updated hook.')
          //alert('update')
        }
      },
      beforeDestroy : function(){
        if( APP_LOG_LIFECYCLE_EVENT){
          console.log('beforeDestroy hook.')
        }
      },
      destroyed : function(){
        if( APP_LOG_LIFECYCLE_EVENT){
          console.log('destroyed hook.')
        }
      }
   }); //옵션객체 {}면 객체임
  </script>
</body>
</html>